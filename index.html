<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ViraP√°gina ‚Äî Loja de Livros Digitais (MVP)</title>
  <meta name="description" content="ViraP√°gina ‚Äî Loja de livros digitais com downloads imediatos e amostras gratuitas." />
  <style>
    :root{--indigo:#4f46e5}*{box-sizing:border-box}body{margin:0;font:16px/1.5 system-ui,Segoe UI,Roboto,Arial;color:#111}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .top{position:sticky;top:0;background:#fffcc;backdrop-filter:saturate(150%) blur(6px);border-bottom:1px solid #eee}
    .brand{color:var(--indigo);font-weight:900;font-size:22px}
    .row{display:flex;gap:12px;align-items:center}
    input,select,button,textarea{padding:10px 12px;border:1px solid #ddd;border-radius:12px}
    button{cursor:pointer}
    .hero{background:linear-gradient(135deg,#eef2ff,#fff);padding:40px 0}
    .hero h1{font-size:36px;line-height:1.1;margin:0 0 10px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
    .card{border:1px solid #eee;border-radius:16px;overflow:hidden;background:#fff;box-shadow:0 1px 6px rgba(0,0,0,.04)}
    .card img{width:100%;height:280px;object-fit:cover;display:block;background:#f3f3f3}
    .p16{padding:16px}.muted{color:#666}.price{font-weight:700}
    .btn{background:var(--indigo);color:#fff;border:none}.btn:hover{filter:brightness(.95)}
    .toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;place-items:center;padding:16px}
    .modal{background:#fff;border-radius:16px;max-width:900px;width:100%;overflow:hidden}
    .modal .row{justify-content:space-between}
    .modal-body{display:grid;grid-template-columns:1fr 1fr}
    .modal img{width:100%;height:100%;object-fit:cover}
    .info{padding:16px}
    .drawer{position:fixed;inset:0;display:none}
    .drawer .shade{position:absolute;inset:0;background:rgba(0,0,0,.5)}
    .drawer .panel{position:absolute;right:0;top:0;height:100%;width:min(420px,100%);background:#fff;display:flex;flex-direction:column}
    .list{display:grid;gap:12px;overflow:auto;padding:16px}
    .cart-item{display:flex;gap:12px;border:1px solid #eee;padding:12px;border-radius:12px}
    .footer{border-top:1px solid #eee;margin-top:40px;padding:24px 0;color:#666;font-size:14px;text-align:center}
    .badge{position:relative}
    .badge i{position:absolute;right:-6px;top:-8px;background:var(--indigo);color:#fff;border-radius:999px;font-style:normal;font-size:11px;padding:2px 6px}
    @media (max-width:800px){.modal-body{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header class="top">
    <div class="container row" style="gap:16px;padding:12px 16px;">
      <div class="brand">ViraP√°gina</div>
      <nav class="row" style="gap:12px;font-size:14px;color:#666">
        <a href="#catalogo">Cat√°logo</a><a href="#faq">FAQ</a>
      </nav>
      <div class="row" style="margin-left:auto;gap:8px;width:100%;max-width:520px">
        <input id="q" placeholder="Procurar livros‚Ä¶" style="flex:1">
        <button id="openCart" class="badge">üõí<i id="cartCount" style="display:none">0</i></button>
      </div>
    </div>
  </header>

  <section class="hero">
    <div class="container">
      <h1>Livros digitais para ler <span style="color:var(--indigo)">onde quiser</span></h1>
      <p class="muted">Cat√°logo selecionado de fic√ß√£o, fantasia, tecnologia e mais. Baixe em EPUB/PDF e comece agora.</p>
    </div>
  </section>

  <main class="container">
    <div class="toolbar">
      <h2 id="catalogo">Cat√°logo</h2>
      <div class="row" style="gap:8px">
        <label class="muted" for="cat">Categoria:</label>
        <select id="cat"></select>
        <label class="muted" for="sort">Ordenar:</label>
        <select id="sort">
          <option value="popular">Mais populares</option>
          <option value="price-asc">Pre√ßo: menor ‚Üí maior</option>
          <option value="price-desc">Pre√ßo: maior ‚Üí menor</option>
          <option value="alpha">Nome A-Z</option>
        </select>
      </div>
    </div>

    <div id="grid" class="grid"></div>

    <section id="faq" style="margin-top:28px">
      <h3>Perguntas frequentes</h3>
      <div class="grid" style="grid-template-columns:repeat(auto-fill,minmax(280px,1fr))">
        <div class="p16" style="border:1px solid #eee;border-radius:12px"><p><strong>Como recebo o meu livro?</strong></p><p class="muted">Ap√≥s a compra, enviamos um link de download por e-mail (simulado neste MVP).</p></div>
        <div class="p16" style="border:1px solid #eee;border-radius:12px"><p><strong>Quais formatos est√£o dispon√≠veis?</strong></p><p class="muted">EPUB e PDF na maioria dos t√≠tulos. Este MVP √© demonstrativo.</p></div>
        <div class="p16" style="border:1px solid #eee;border-radius:12px"><p><strong>Posso ler uma amostra?</strong></p><p class="muted">Sim! Abra o livro e clique em <em>Ler amostra</em>.</p></div>
        <div class="p16" style="border:1px solid #eee;border-radius:12px"><p><strong>Posso pedir reembolso?</strong></p><p class="muted">Sim, em at√© 7 dias para compras digitais n√£o baixadas (pol√≠tica demonstrativa).</p></div>
      </div>
    </section>
  </main>

  <!-- Modal Livro -->
  <div id="modal" class="modal-bg">
    <div class="modal">
      <div class="modal-body">
        <div><img id="mCover" alt="capa" /></div>
        <div class="info">
          <div class="row"><h3 id="mTitle" style="margin:0"></h3><button id="mClose">‚úï</button></div>
          <p class="muted" id="mAuthor"></p>
          <p id="mDesc" class="muted"></p>
          <p><strong id="mPrice"></strong> <span class="muted" id="mRating"></span></p>
          <div class="row" style="gap:8px;margin-top:8px">
            <button class="btn" id="mAdd">Adicionar ao carrinho</button>
            <button id="mPreviewBtn">Ler amostra</button>
          </div>
          <pre id="mPreview" style="white-space:pre-wrap;background:#fafafa;border:1px solid #eee;border-radius:12px;padding:12px;display:none;margin-top:12px"></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- Drawer Carrinho -->
  <div id="drawer" class="drawer">
    <div class="shade" id="dShade"></div>
    <div class="panel">
      <div class="row" style="justify-content:space-between;border-bottom:1px solid #eee;padding:12px 16px">
        <strong>Seu carrinho</strong>
        <button id="dClose">Fechar</button>
      </div>
      <div id="dList" class="list"></div>
      <div style="border-top:1px solid #eee;padding:12px 16px">
        <div class="row" style="justify-content:space-between">
          <span>Subtotal</span><strong id="dSubtotal">‚Ç¨0,00</strong>
        </div>
        <button id="dCheckout" class="btn" style="width:100%;margin-top:8px">Finalizar compra</button>
      </div>
    </div>
  </div>

  <footer class="footer">¬© <span id="y"></span> ViraP√°gina. Todos os direitos reservados.</footer>

  <script>
    // ----- Dados -----
    const CATEGORIES = ["Todos","Fic√ß√£o","Fantasia","Tecnologia","Neg√≥cios","N√£o-fic√ß√£o"];
    const BOOKS = [
      {id:"bk-001",title:"A Cidade das N√©voas",author:"L. Andrade",price:9.9,category:"Fic√ß√£o",rating:4.7,cover:"https://images.unsplash.com/photo-1512820790803-83ca734da794?q=80&w=800&auto=format&fit=crop",description:"Um suspense atmosf√©rico sobre segredos enterrados e escolhas imposs√≠veis.",preview:"Cap√≠tulo 1\n\nA n√©voa cobria as ruas como um cobertor antigo. Ana parou em frente √† livraria..."},
      {id:"bk-002",title:"Manual Pr√°tico de React",author:"C. Nogueira",price:14.5,category:"Tecnologia",rating:4.8,cover:"https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=800&auto=format&fit=crop",description:"Um guia moderno para criar interfaces r√°pidas e acess√≠veis com React.",preview:"Introdu√ß√£o\n\nEste livro cobre fundamentos e padr√µes para criar SPAs profissionais..."},
      {id:"bk-003",title:"O Mago de √Çmbar",author:"V. Soares",price:11.9,category:"Fantasia",rating:4.5,cover:"https://images.unsplash.com/photo-1495446815901-a7297e633e8d?q=80&w=800&auto=format&fit=crop",description:"Magia antiga, pol√≠tica e um destino que ningu√©m ousou prever.",preview:"Pr√≥logo\n\nQuando as torres acesas cantaram, o sil√™ncio partiu-se em quatro..."},
      {id:"bk-004",title:"Estrat√©gia em 30 Dias",author:"M. Carvalho",price:12.0,category:"Neg√≥cios",rating:4.2,cover:"https://images.unsplash.com/photo-1516979187457-637abb4f9353?q=80&w=800&auto=format&fit=crop",description:"Ferramentas e frameworks para planeamento e execu√ß√£o √°gil.",preview:"Dia 1\n\nAntes de definir metas, me√ßa a realidade: pessoas, processos e produto..."},
      {id:"bk-005",title:"Respirar Melhor",author:"N. Freitas",price:7.5,category:"N√£o-fic√ß√£o",rating:4.3,cover:"https://images.unsplash.com/photo-1491841651911-c44c30c34548?q=80&w=800&auto=format&fit=crop",description:"H√°bitos simples para energia, foco e um sono mais profundo.",preview:"Respira√ß√£o 4-7-8\n\nUma t√©cnica simples que acalma o sistema nervoso..."},
      {id:"bk-006",title:"Design de Capas Cativantes",author:"A. Ramos",price:10.9,category:"Tecnologia",rating:4.6,cover:"https://images.unsplash.com/photo-1541963463532-d68292c34b19?q=80&w=800&auto=format&fit=crop",description:"Princ√≠pios visuais e tipogr√°ficos para capas de e-books que vendem.",preview:"Cores e contraste\n\nA primeira leitura √© visual. Antes do t√≠tulo, o impacto..."},
      {id:"bk-007",title:"O √öltimo Farol",author:"R. Almeida",price:8.9,category:"Fic√ß√£o",rating:4.1,cover:"https://images.unsplash.com/photo-1524995997946-a1c2e315a42f?q=80&w=800&auto=format&fit=crop",description:"Um drama √≠ntimo sobre perda, esperan√ßa e um farol que nunca apaga.",preview:"Luzes ao norte\n\nDiziam que, em noite clara, dava para ver os barcos de outras vidas..."},
      {id:"bk-008",title:"Copywriting Essencial",author:"S. P. Lima",price:9.5,category:"Neg√≥cios",rating:4.4,cover:"https://images.unsplash.com/photo-1553729459-efe14ef6055d?q=80&w=800&auto=format&fit=crop",description:"Como escrever textos que convertem sem soar for√ßado.",preview:"O poder das provas\n\nDepoimentos e n√∫meros tornam promessas cr√≠veis..."},
      {id:"bk-009",title:"Atlas do Dev",author:"B. Teixeira",price:13.9,category:"Tecnologia",rating:4.9,cover:"https://images.unsplash.com/photo-1517433456452-f9633a875f6f?q=80&w=800&auto=format&fit=crop",description:"Caminhos de carreira, ferramentas e mapas mentais para devs.",preview:"Mapa 1: Web\n\nFront-end, back-end, DevOps ‚Äî como decidir por onde come√ßar..."},
      {id:"bk-010",title:"Cr√¥nicas do Bosque",author:"I. Matos",price:6.9,category:"Fantasia",rating:4.0,cover:"https://images.unsplash.com/photo-1526312426976-593c24387fb3?q=80&w=800&auto=format&fit=crop",description:"Criaturas antigas, pactos secretos e uma crian√ßa destinada a unir reinos.",preview:"O sussurro das folhas\n\nCada √°rvore guardava um nome. E cada nome, um pacto..."}
    ];
    const formatEUR = n => new Intl.NumberFormat("pt-PT",{style:"currency",currency:"EUR"}).format(n);

    // ----- Estado -----
    let state = { q:"", cat:"Todos", sort:"popular", cart: JSON.parse(localStorage.getItem("cart")||"[]") };

    // ----- Refs -----
    const q = document.getElementById("q");
    const cat = document.getElementById("cat");
    const sort = document.getElementById("sort");
    const grid = document.getElementById("grid");
    const cartCount = document.getElementById("cartCount");

    // Modal
    const modalBG = document.getElementById("modal");
    const mClose = document.getElementById("mClose");
    const mCover = document.getElementById("mCover");
    const mTitle = document.getElementById("mTitle");
    const mAuthor = document.getElementById("mAuthor");
    const mDesc = document.getElementById("mDesc");
    const mPrice = document.getElementById("mPrice");
    const mRating = document.getElementById("mRating");
    const mAdd = document.getElementById("mAdd");
    const mPreview = document.getElementById("mPreview");
    const mPreviewBtn = document.getElementById("mPreviewBtn");

    // Carrinho
    const drawer = document.getElementById("drawer");
    const dShade = document.getElementById("dShade");
    const dClose = document.getElementById("dClose");
    const dList = document.getElementById("dList");
    const dSubtotal = document.getElementById("dSubtotal");
    const dCheckout = document.getElementById("dCheckout");

    // ----- Init -----
    CATEGORIES.forEach(c=>{ const o=document.createElement("option"); o.value=c; o.textContent=c; cat.appendChild(o); });

    function render(){
      // badge carrinho
      const count = state.cart.reduce((a,i)=>a+i.qty,0);
      cartCount.textContent = count; cartCount.style.display = count ? "inline-block" : "none";

      // filtrar/ordenar
      let list = BOOKS.filter(b =>
        (state.cat==="Todos"||b.category===state.cat) &&
        (`${b.title} ${b.author}`.toLowerCase().includes(state.q.toLowerCase()))
      );
      switch(state.sort){
        case "price-asc": list.sort((a,b)=>a.price-b.price); break;
        case "price-desc": list.sort((a,b)=>b.price-a.price); break;
        case "alpha": list.sort((a,b)=>a.title.localeCompare(b.title)); break;
        default: list.sort((a,b)=>b.rating-a.rating);
      }

      // cards
      grid.innerHTML = "";
      list.forEach(b=>{
        const card = document.createElement("div");
        card.className="card";
        card.innerHTML = `
          <img src="${b.cover}" alt="capa">
          <div class="p16">
            <h3 style="margin:0 0 4px 0">${b.title}</h3>
            <p class="muted" style="margin:0">${b.author}</p>
            <div class="row" style="justify-content:space-between;margin-top:8px">
              <span class="price">${formatEUR(b.price)}</span>
              <span class="muted">‚≠ê ${b.rating}</span>
            </div>
          </div>
          <div class="p16" style="padding-top:0">
            <button class="btn" style="width:100%" data-add="${b.id}">Adicionar ao carrinho</button>
          </div>`;
        card.querySelector("img").addEventListener("click",()=>openModal(b));
        card.querySelector("[data-add]").addEventListener("click",()=>addToCart(b));
        grid.appendChild(card);
      });

      localStorage.setItem("cart", JSON.stringify(state.cart));
    }

    function openModal(b){
      mCover.src=b.cover; mTitle.textContent=b.title; mAuthor.textContent="de "+b.author;
      mDesc.textContent=b.description; mPrice.textContent=formatEUR(b.price); mRating.textContent="‚≠ê "+b.rating;
      mPreview.style.display="none"; mPreview.textContent=b.preview;
      mAdd.onclick = ()=>{ addToCart(b); closeModal(); };
      mPreviewBtn.onclick = ()=>{ mPreview.style.display = (mPreview.style.display==="none"?"block":"none"); };
      modalBG.style.display="grid";
    }
    function closeModal(){ modalBG.style.display="none"; }

    function openCart(){ renderCart(); drawer.style.display="block"; }
    function closeCart(){ drawer.style.display="none"; }

    function addToCart(b){
      const i = state.cart.findIndex(x=>x.id===b.id);
      if(i>=0) state.cart[i].qty++; else state.cart.push({...b, qty:1});
      render();
    }
    function minusFromCart(id){
      const i = state.cart.findIndex(x=>x.id===id);
      if(i<0) return; state.cart[i].qty--; if(state.cart[i].qty<=0) state.cart.splice(i,1);
      renderCart(); render();
    }
    function plusInCart(id){
      const i = state.cart.findIndex(x=>x.id===id);
      if(i<0) return; state.cart[i].qty++;
      renderCart(); render();
    }
    function renderCart(){
      dList.innerHTML=""; let subtotal=0;
      state.cart.forEach(it=>{
        subtotal += it.price*it.qty;
        const row = document.createElement("div");
        row.className="cart-item";
        row.innerHTML = `
          <img src="${it.cover}" alt="" style="width:64px;height:80px;object-fit:cover;border-radius:8px">
          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;gap:8px">
              <strong>${it.title}</strong>
              <span class="muted">${formatEUR(it.price)}</span>
            </div>
            <div class="row" style="gap:8px;margin-top:6px">
              <button data-minus="${it.id}">‚àí</button>
              <span>${it.qty}</span>
              <button data-plus="${it.id}">+</button>
            </div>
          </div>`;
        row.querySelector("[data-minus]").onclick = ()=>minusFromCart(it.id);
        row.querySelector("[data-plus]").onclick = ()=>plusInCart(it.id);
        dList.appendChild(row);
      });
      dSubtotal.textContent = formatEUR(subtotal);
    }

    // eventos
    q.oninput = e=>{ state.q=e.target.value; render(); };
    cat.onchange = e=>{ state.cat=e.target.value; render(); };
    sort.onchange= e=>{ state.sort=e.target.value; render(); };
    document.getElementById("openCart").onclick = openCart;
    document.getElementById("dShade").onclick = document.getElementById("dClose").onclick = closeCart;
    document.getElementById("mClose").onclick = closeModal;
    document.getElementById("dCheckout").onclick = ()=>{
      alert("Pagamento simulado! Enviaremos um link de download por e-mail.");
      state.cart=[]; render(); closeCart();
    };

    document.getElementById("y").textContent = new Date().getFullYear();

    // garante que roda com DOM carregado
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", render, { once: true });
    } else {
      render();
    }
  </script>
</body>
</html>
